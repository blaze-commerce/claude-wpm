# Claude Code WordPress Configuration

Reusable Claude Code configuration for WordPress/WooCommerce projects hosted on Kinsta.

## What's Included

```
.claude/
├── CLAUDE-BASE.md          # Reusable instructions (auto-loaded by Claude)
├── README.md               # This file - setup instructions
├── hooks/
│   └── PreToolUse/
│       ├── block-dangerous-commands.sh
│       └── block-protected-files.sh
├── skills/
│   ├── wordpress-master.md
│   ├── php-pro.md
│   ├── security-auditor.md
│   └── database-administrator.md
├── commands/
│   └── wpm.md              # /wpm - WordPress maintenance command
├── scripts/
│   ├── blz-wpm.sh          # Direct SSH maintenance script
│   └── update-premium-plugins.sh  # Premium plugin updater
├── docs/
│   └── premium-plugins-list.md    # Premium plugins documentation
└── settings.json           # Permissions and hook configuration
```

## Deployment to Kinsta Sites

This configuration is designed to be deployed to every Kinsta WordPress instance managed by Blaze Commerce.

### Download & Deploy Workflow

```
┌──────────────────────────────────────────────────────────────────────┐
│  1. Download latest release from GitHub                              │
│  2. Extract zip (creates .claude/ folder - no renaming needed)       │
│  3. Upload .claude/ folder to Kinsta site root (public/)             │
│  4. Start Claude Code and run /init                                  │
│  5. Run /wpm to populate plugin inventory                            │
└──────────────────────────────────────────────────────────────────────┘
```

### Step-by-Step Deployment

#### 1. Download Release
Go to [Releases](https://github.com/blaze-commerce/claude-wpm/releases) and download:
- `claude-wpm-deploy.zip` (always latest version)
- Or `claude-wpm-deploy-vX.X.X.zip` (specific version)

#### 2. Upload Zip to Kinsta Server
Upload the **zip file** (not extracted) to your WordPress root:
```
/public/
├── claude-wpm-deploy.zip   ← Upload zip here
├── wp-content/
├── wp-config.php
└── ...
```

**Upload methods:**
- SFTP (FileZilla, Cyberduck)
- Kinsta File Manager
- SSH: `scp claude-wpm-deploy.zip user@site.kinsta.cloud:~/public/`

#### 3. Extract on Server (via Claude Code)
Start Claude Code on the Kinsta site and ask it to extract:

```bash
# Claude will run:
cd ~/public
unzip claude-wpm-deploy.zip
rm claude-wpm-deploy.zip  # Clean up zip file
```

> **How it works:** The zip contains `.claude/` at the root, so extraction automatically creates the correct folder structure - **no renaming needed!**
>
> ```
> claude-wpm-deploy-v1.0.0.zip    ← Zip filename (for version tracking)
>    └── .claude/                 ← Folder inside zip (extracted as-is)
>          ├── commands/
>          ├── hooks/
>          ├── scripts/
>          └── ...
> ```

#### 4. Initialize Configuration
After extraction, run in Claude Code:
```
/init    # Generates site-specific CLAUDE.md
/wpm     # Updates plugins and populates inventory
```

### Quick Reference

| Step | Action | Result |
|------|--------|--------|
| 1. Download | Get `claude-wpm-deploy.zip` from GitHub Releases | Versioned package |
| 2. Upload | Upload zip to Kinsta `public/` folder | Zip on server |
| 3. Extract | Claude runs `unzip claude-wpm-deploy.zip` | Creates `.claude/` folder |
| 4. Cleanup | Claude runs `rm claude-wpm-deploy.zip` | Remove zip file |
| 5. Init | Run `/init` in Claude Code | Site-specific CLAUDE.md |
| 6. Update | Run `/wpm` | Plugins updated, inventory populated |

The reusable instructions in `.claude/CLAUDE-BASE.md` are auto-loaded alongside your site-specific `CLAUDE.md`.

## Recommended CLAUDE.md Structure

After running `/init`, ensure your `CLAUDE.md` includes these sections for full compatibility with `/wpm`:

```markdown
# CLAUDE.md

## Site Overview
[Brief description of the site - type, theme, purpose]

## Directory Structure
[Generated by /init]

## Child Theme Customizations
| File | Purpose |
|------|---------|
[Document key custom files]

## Key Plugins
[Categorize important plugins: E-commerce, Payments, Shipping, SEO, etc.]

## Custom Endpoints / APIs
[Document any custom REST endpoints]

## Plugin Inventory

**Last updated:** [DATE] via `/wpm`

This section is auto-updated when running `/wpm`. New plugins are marked with `<- NEW`.

### Active Plugins

| Plugin | Version | Notes |
|--------|---------|-------|

### Inactive Plugins

| Plugin | Version | Notes |
|--------|---------|-------|

### Must-Use Plugins

| Plugin | Version | Notes |
|--------|---------|-------|
```

**Important:** The `## Plugin Inventory` section with the table format is required for `/wpm` to auto-update plugin lists.

## Premium Plugins

Premium plugins are managed via a private Git repository since they can't be updated via `wp plugin update --all`.

**Repository:** `git@github.com:blaze-commerce/wp-premium-plugins.git`

**Source:** Most premium plugins are downloaded from https://www.gpltimes.com/

**Managed plugins:**
- elementor-pro
- gp-premium
- perfmatters
- woo-checkout-field-editor-pro
- admin-site-enhancements-pro
- wp-mail-smtp-pro
- surerank-pro

**How it works:**
1. Premium plugin zips are stored in the private repo
2. `/wpm` command calls `update-premium-plugins.sh` automatically
3. Script pulls repo, extracts zips to wp-content/plugins
4. If a plugin has no zip in repo, it's safely skipped (existing plugin untouched)

**Manual usage:**
```bash
.claude/scripts/update-premium-plugins.sh list        # Show available plugins
.claude/scripts/update-premium-plugins.sh update-all  # Update all premium plugins
.claude/scripts/update-premium-plugins.sh update elementor-pro  # Update one plugin
```

## Features

### Safety Hooks
PreToolUse hooks that block dangerous operations:
- Destructive commands (`rm -rf`, `DROP DATABASE`, etc.)
- `wp kinsta cache purge` (causes performance issues on Kinsta)
- Modifications to WordPress core, wp-config.php, parent themes

### Skills (Specialists)
Invoke with `/skill-name`:
- `/wordpress-master` - WordPress/WooCommerce expertise
- `/php-pro` - PHP development
- `/security-auditor` - Security review
- `/database-administrator` - MySQL optimization

### Commands
- `/wpm` - WordPress Maintenance (updates core, free plugins, premium plugins, themes in correct order)

## Configuration Sources

| Component | Source |
|-----------|--------|
| Hooks | [claude-code-mastery](https://github.com/TheDecipherist/claude-code-mastery) |
| Skills | [awesome-claude-code-subagents](https://github.com/VoltAgent/awesome-claude-code-subagents) |

## Auto-Update Check

Claude is instructed (in CLAUDE-BASE.md) to check the source repositories at the start of each session for new hooks/skills.

## License

MIT - Feel free to customize for your needs.

---

Maintained by Blaze Commerce
